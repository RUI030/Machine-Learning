# 機器學習導論期末報告
`工工系／林珮瑜／111704050`
`電機系／林芮羽／109511208`

## 簡介 Introduction
<!-- + Related work 懶得寫兩段了 -->
本次機器學習導論期末專題題目為影像二分類。給定的人像圖片資料集，訓練一個能將影像分類成 `adults`、`children` 兩個類別的模型。資料集已進行標記（labeled），因此本次的作業屬於監督式學習（supervised learning）。

### 資料集

各類別圖片數量如下表：
| 資料集\類別 |  adults  | children |
| -------- | -------- | -------- |
| **訓練資料集**  | 280     | 280       |
| **驗證資料集**  | 60      | 60       |


### 方法


## 模型架構 Model

> 模型串串的圖片(我等等畫)

### Neural Network

### ResNet
#### 圖像轉換：
將圖片尺寸修改為224*224，並且對圖片標準化。
#### 定義Basic Block：
1. 設置為 Residual Block ，透過優化 $H(X)-x$ 進行學習。
2. 具體構造設置為一層卷積層接一層標準化層（BN），以此構造連接兩次。
3. kernel_size = 3，學習步伐 stride = 1。

#### 定義前向傳播：
將輸入x通過一次卷積層、一次BN層、一次ReLU，再通過一次卷積層與一次BN層，將輸出連接殘差再通過ReLU成為最後輸出。
#### 定義Layer：
1. 指定strides為該層連接的Block數量。
2. 更新輸出通道數並連接起Block。
#### 定義Net：
1. 先進一層卷積層將輸入的3個通道(R、G、B)轉換為設定的通道數量再進入BN層正規化。
2. 進入4個由不同設定的block組成的層進行運算。
3. 進入池化層，這裡我們採用平均池化。
4. 進入全連接層，輸出預測的類別。

### DenseNet

## 資料預處理 Preprocessing
為了讓模型有效地抓到跟年齡相關的特徵，我們決定使用MTCNN進行臉部偵測後裁切圖片。經實驗觀察後發現，裁切後的圖片再進行LBP能有效提高模型預測的準確度。
### MTCNN：Multi-task convolutional neural network
#### Introduction
透過三個訓練好的Net：P-net、R-net、O-net組合起一個演算法，三個子網路相對簡單，方便逐層篩選。
MTCNN不直接預測框，而是透過學習bias反推預測框。
#### 放大圖像
使用雙三次插值（INTER_CUBIC）來縮放圖像，因為裁切人臉會讓圖片變小。為了更好訓練將圖片放大並且使用雙三次插值補值，這種方法會較多保留細部細節。
#### 轉換色彩格式並轉換為 PIL 圖像
MTCNN 檢測需要 PIL 圖像格式。但numpy轉PIL在進行essemble learing的時候會因為轉值問題導致速度變慢。
#### 使用MTCNN進行預測人臉
直接使用訓練好的模型進行預測。
#### 檢查是否檢測到人臉與只使用置信度最高的人臉
透過confidences.argmax()尋找最高置信度的人臉，避免一張圖片偵測過多人臉導致最後準確度下降。
### LBP


## 實驗 Experiment

## 結論 Conclusion

## 心得
### ㄆㄩ
我想下班=.=
### 林芮羽
